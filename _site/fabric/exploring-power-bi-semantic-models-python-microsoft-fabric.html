<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108906622-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-108906622-1', { 'anonymize_ip': true }); </script> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Exploring Power BI Semantic Models with Python in Microsoft Fabric | LazySnail</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="Exploring Power BI Semantic Models with Python in Microsoft Fabric" /><meta property="og:locale" content="en_US" /><meta name="description" content="Power BI Fan page" /><meta property="og:description" content="Power BI Fan page" /><link rel="canonical" href="http://localhost:4000/fabric/exploring-power-bi-semantic-models-python-microsoft-fabric" /><meta property="og:url" content="http://localhost:4000/fabric/exploring-power-bi-semantic-models-python-microsoft-fabric" /><meta property="og:site_name" content="LazySnail" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-13T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Exploring Power BI Semantic Models with Python in Microsoft Fabric" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-13T00:00:00+01:00","datePublished":"2025-03-13T00:00:00+01:00","description":"Power BI Fan page","headline":"Exploring Power BI Semantic Models with Python in Microsoft Fabric","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/fabric/exploring-power-bi-semantic-models-python-microsoft-fabric"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/logo_lazysnail.png"}},"url":"http://localhost:4000/fabric/exploring-power-bi-semantic-models-python-microsoft-fabric"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item active"><a href="/docs/Fabric" class="nav-list-link">Fabric</a><li class="nav-list-item"><a href="/docs/Power-BI" class="nav-list-link">Power BI</a><li class="nav-list-item"><a href="/docs/SQL%20Server" class="nav-list-link">SQL Server</a><li class="nav-list-item"><a href="/docs/Obsidian" class="nav-list-link">Obsidian</a><li class="nav-list-item"><a href="/docs/Other" class="nav-list-link">Other</a><li class="nav-list-item"><a href="/docs/Links" class="nav-list-link">Links</a><li class="nav-list-item"><a href="/docs/About" class="nav-list-link">About Me</a></ul></nav></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search LazySnail" aria-label="Search LazySnail" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/Fabric">Fabric</a><li class="breadcrumb-nav-list-item"><span>Exploring Power BI Semantic Models with Python in Microsoft Fabric</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="fs-9" id="exploring-power-bi-semantic-models-with-python-in-microsoft-fabric"> <a href="#exploring-power-bi-semantic-models-with-python-in-microsoft-fabric" class="anchor-heading" aria-labelledby="exploring-power-bi-semantic-models-with-python-in-microsoft-fabric"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploring Power BI Semantic Models with Python in Microsoft Fabric</h1><p style="text-align: center;" class="image50"><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/Python_Lazysnail.jpeg" alt="image" /></p><blockquote class="note-title"><p>What?</p><p>Microsoft Fabric provides a powerful way to interact with <strong>Power BI Semantic Models</strong> using Python, enabling data professionals to explore, analyze, and visualize model metadata efficiently. Whether you need to list tables, retrieve measures, execute SQL/DAX queries, or inspect dependencies, Python and the <strong>Semantic Link</strong> extension make it seamless.</p><p>In this post, I’ll walk you through various operations on a <strong>Power BI Semantic Model</strong> within Microsoft Fabric, covering essential tasks such as querying metadata, visualizing relationships, and tracking dataset refreshes.</p></blockquote><h2 id="why-work-with-power-bi-semantic-models-in-python"> <a href="#why-work-with-power-bi-semantic-models-in-python" class="anchor-heading" aria-labelledby="why-work-with-power-bi-semantic-models-in-python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Why Work with Power BI Semantic Models in Python?</strong></h2><p>Using Python with <strong>Microsoft Fabric</strong> and <strong>Semantic Link</strong> provides several advantages:</p><ul><li><strong>Enhanced Model Exploration</strong> – Retrieve metadata about tables, measures, relationships, and dependencies.<li><strong>Efficient Data Queries</strong> – Execute <strong>SQL and DAX queries</strong> directly within a notebook.<li><strong>Model Dependency Analysis</strong> – Understand how columns, measures, and expressions interconnect.<li><strong>Automated Insights &amp; Reporting</strong> – Leverage Python to automate model inspection and streamline reporting.</ul><h2 id="what-this-post-covers"> <a href="#what-this-post-covers" class="anchor-heading" aria-labelledby="what-this-post-covers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>What This Post Covers</strong></h2><p>This article will explore various <strong>Python-based operations</strong> on a Power BI Semantic Model, including:</p><ul><li><strong>Listing tables and measures</strong> in the semantic model.<li><strong>Executing SQL and DAX queries</strong> to retrieve aggregated insights.<li><strong>Visualizing model relationships</strong> to understand dependencies.<li><strong>Analyzing column impact</strong> to track measure and hierarchy usage.<li><strong>Extracting M code expressions</strong> for reviewing data transformations.<li><strong>Checking dataset refresh status</strong> to monitor data updates.</ul><p>With these capabilities, you’ll be able to <strong>better explore and manage Power BI Semantic Models</strong> within <strong>Microsoft Fabric</strong>, unlocking deeper insights into your data.</p><hr /><p>For this example, I used a Power BI file that already contains data, making it easy to use for testing.<br /> You can download it here: <a href="https://github.com/arnaudgastelblum/LazyDAX/raw/master/LazyDAX.pbix">LazyDAX.pbix</a>.</p><p>You can also view or download the complete notebook from my GitHub repository:<br /> <a href="https://github.com/arnaudgastelblum/LazySnail/blob/master/Notebook_SemanticLink.ipynb">Notebook_SemanticLink.ipynb</a>.</p><hr /><h2 id="setup-installing-and-importing-required-libraries"> <a href="#setup-installing-and-importing-required-libraries" class="anchor-heading" aria-labelledby="setup-installing-and-importing-required-libraries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setup: Installing and Importing Required Libraries</h2><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">semantic</span><span class="o">-</span><span class="n">link</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">sempy</span>

<span class="kn">import</span> <span class="nn">sempy.fabric</span> <span class="k">as</span> <span class="n">fabric</span>
</code></pre></div></div><h2 id="exploring-power-bi-semantic-models-with-python-in-microsoft-fabric-1"> <a href="#exploring-power-bi-semantic-models-with-python-in-microsoft-fabric-1" class="anchor-heading" aria-labelledby="exploring-power-bi-semantic-models-with-python-in-microsoft-fabric-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploring Power BI Semantic Models with Python in Microsoft Fabric</h2><h3 id="list-tables-from-a-power-bi-semantic-model"> <a href="#list-tables-from-a-power-bi-semantic-model" class="anchor-heading" aria-labelledby="list-tables-from-a-power-bi-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List tables from a Power BI Semantic Model</h3><p>The <code class="language-plaintext highlighter-rouge">list_tables()</code> function in the Semantic Link extension retrieves the list of available tables in a Microsoft Fabric semantic model. It helps explore the model by displaying the names of accessible tables.</p><p><a href="https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-tables">https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-tables</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s">"LazyDAX"</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image.png" alt="alt text" /></p><h3 id="list-measures-from-a-power-bi-semantic-model"> <a href="#list-measures-from-a-power-bi-semantic-model" class="anchor-heading" aria-labelledby="list-measures-from-a-power-bi-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List Measures from a Power BI Semantic Model</h3><p>The <code class="language-plaintext highlighter-rouge">list_measures()</code> function retrieves all measures from a dataset in a Microsoft Fabric semantic model. It provides an overview of the available calculated metrics.</p><p><a href="https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-measures">https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-measures</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_measures</span><span class="p">(</span><span class="s">"LazyDAX"</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-1.png" alt="alt text" /></p><h2 id="querying-dax"> <a href="#querying-dax" class="anchor-heading" aria-labelledby="querying-dax"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Querying DAX</h2><p>This section demonstrates how to run a DAX query in a Python notebook within Microsoft Fabric using the Semantic Link (<code class="language-plaintext highlighter-rouge">sempy</code>) extension.</p><h3 id="execute-a-dax-query"> <a href="#execute-a-dax-query" class="anchor-heading" aria-labelledby="execute-a-dax-query"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execute a DAX Query</h3><p>The <code class="language-plaintext highlighter-rouge">%%dax</code> cell magic runs a DAX query directly within the notebook.<br /> “LazyDAX” refers to the semantic model being queried.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">dax</span> <span class="s">"LazyDAX"</span>
<span class="n">EVALUATE</span>
<span class="n">SUMMARIZECOLUMNS</span><span class="p">(</span>
    <span class="s">'Customer'</span><span class="p">[</span><span class="n">Country</span><span class="p">],</span>
    <span class="s">"test"</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span><span class="n">Sales</span><span class="p">[</span><span class="n">TotalAmount</span><span class="p">])</span>
<span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-2.png" alt="alt text" /></p><h2 id="querying-a-power-bi-semantic-model-with-sql"> <a href="#querying-a-power-bi-semantic-model-with-sql" class="anchor-heading" aria-labelledby="querying-a-power-bi-semantic-model-with-sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Querying a Power BI Semantic Model with SQL</h2><p>This section demonstrates how to use SQL queries to retrieve data from a Power BI Semantic Model in Microsoft Fabric.</p><h3 id="configure-spark-to-access-the-semantic-model"> <a href="#configure-spark-to-access-the-semantic-model" class="anchor-heading" aria-labelledby="configure-spark-to-access-the-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configure Spark to Access the Semantic Model</h3><p>The following command configures Spark to use the Power BI Spark native connector for Spark SQL.</p><p><a href="https://learn.microsoft.com/en-us/fabric/data-science/semantic-link-power-bi?tabs=sql">https://learn.microsoft.com/en-us/fabric/data-science/semantic-link-power-bi?tabs=sql</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">spark</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="s">"spark.sql.catalog.pbi"</span><span class="p">,</span> <span class="s">"com.microsoft.azure.synapse.ml.powerbi.PowerBICatalog"</span><span class="p">)</span>
</code></pre></div></div><h3 id="retrieve-data-from-a-table"> <a href="#retrieve-data-from-a-table" class="anchor-heading" aria-labelledby="retrieve-data-from-a-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Retrieve Data from a Table</h3><p>The <code class="language-plaintext highlighter-rouge">%sql</code> cell magic allows executing SQL queries within the notebook.<br /> This query retrieves all columns from the <code class="language-plaintext highlighter-rouge">Customer</code> table inside the <code class="language-plaintext highlighter-rouge">LazyDAX</code> semantic model.</p><div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="k">sql</span>
<span class="k">SELECT</span> <span class="o">*</span> 
<span class="k">FROM</span> <span class="n">pbi</span><span class="p">.</span><span class="nv">`LazyDAX`</span><span class="p">.</span><span class="n">Customer</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-3.png" alt="alt text" /></p><h3 id="aggregating-data-with-sql"> <a href="#aggregating-data-with-sql" class="anchor-heading" aria-labelledby="aggregating-data-with-sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Aggregating Data with SQL</h3><p>This query achieves the same result as the previous DAX expression, but using SQL on the same Power BI Semantic Model.<br /> Here, we not only aggregate data but also join tables to combine relevant information:</p><div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="k">sql</span>
<span class="k">SELECT</span> 
    <span class="n">Customer</span><span class="p">.</span><span class="n">Country</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">Sales</span><span class="p">.</span><span class="n">TotalAmount</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">pbi</span><span class="p">.</span><span class="nv">`LazyDAX`</span><span class="p">.</span><span class="n">Sales</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">pbi</span><span class="p">.</span><span class="nv">`LazyDAX`</span><span class="p">.</span><span class="n">Customer</span> 
    <span class="k">ON</span> <span class="n">Customer</span><span class="p">.</span><span class="n">PK_Customer</span> <span class="o">=</span> <span class="n">Sales</span><span class="p">.</span><span class="n">FK_Customer</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">Customer</span><span class="p">.</span><span class="n">Country</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-4.png" alt="alt text" /></p><h1 id="visualizing-the-data-model"> <a href="#visualizing-the-data-model" class="anchor-heading" aria-labelledby="visualizing-the-data-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Visualizing the Data Model</h1><p>This section demonstrates how to extract and visualize relationships within a Power BI Semantic Model using the Semantic Link extension in Microsoft Fabric.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sempy.fabric</span> <span class="k">as</span> <span class="n">fabric</span>
<span class="kn">import</span> <span class="nn">pyspark.sql.functions</span> <span class="k">as</span> <span class="n">F</span>

<span class="kn">from</span> <span class="nn">sempy.relationships</span> <span class="kn">import</span> <span class="n">plot_relationship_metadata</span>
<span class="kn">from</span> <span class="nn">sempy.relationships</span> <span class="kn">import</span> <span class="n">find_relationships</span>

<span class="n">relationships</span> <span class="o">=</span> <span class="n">fabric</span><span class="p">.</span><span class="n">list_relationships</span><span class="p">(</span><span class="s">"LazyDAX"</span><span class="p">)</span>
<span class="n">plot_relationship_metadata</span><span class="p">(</span><span class="n">relationships</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-5.png" alt="alt text" /></p><h1 id="dax-semantic-model-information"> <a href="#dax-semantic-model-information" class="anchor-heading" aria-labelledby="dax-semantic-model-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DAX Semantic Model Information</h1><h2 id="exploring-active-relationships-in-a-power-bi-semantic-model"> <a href="#exploring-active-relationships-in-a-power-bi-semantic-model" class="anchor-heading" aria-labelledby="exploring-active-relationships-in-a-power-bi-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploring Active Relationships in a Power BI Semantic Model</h2><p>This section demonstrates how to retrieve active relationships from a Power BI Semantic Model using a DAX query.</p><div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">dax</span> <span class="nv">"LazyDAX"</span>
<span class="k">SELECT</span> <span class="o">*</span> 
<span class="k">FROM</span> <span class="err">$</span><span class="k">System</span><span class="p">.</span><span class="n">DISCOVER_CALC_DEPENDENCY</span> 
<span class="k">WHERE</span> <span class="n">OBJECT_TYPE</span> <span class="o">=</span> <span class="s1">'ACTIVE_RELATIONSHIP'</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-6.png" alt="alt text" /></p><h2 id="column-impact-who-uses-this-column"> <a href="#column-impact-who-uses-this-column" class="anchor-heading" aria-labelledby="column-impact-who-uses-this-column"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Column Impact: Who Uses This Column?</h2><p>This section demonstrates how to analyze the impact of a specific column in a Power BI Semantic Model using a DAX query.</p><div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">dax</span> <span class="nv">"LazyDAX"</span>
<span class="n">EVALUATE</span>
<span class="n">FILTER</span><span class="p">(</span>
    <span class="n">INFO</span><span class="p">.</span><span class="n">CALCDEPENDENCY</span><span class="p">(),</span>
    <span class="p">[</span><span class="n">REFERENCED_TABLE</span><span class="p">]</span> <span class="o">=</span> <span class="nv">"Calendar"</span>
    <span class="o">&amp;&amp;</span> <span class="p">[</span><span class="n">REFERENCED_OBJECT</span><span class="p">]</span> <span class="o">=</span> <span class="nv">"Year"</span>
<span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-7.png" alt="alt text" /></p><h1 id="fabric--power-bi-capacities"> <a href="#fabric--power-bi-capacities" class="anchor-heading" aria-labelledby="fabric--power-bi-capacities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Fabric / Power BI Capacities</h1><p><a href="https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-capacities">https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-capacities</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_capacities</span><span class="p">()</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-8.png" alt="alt text" /></p><h2 id="exploring-m-code-in-a-power-bi-semantic-model"> <a href="#exploring-m-code-in-a-power-bi-semantic-model" class="anchor-heading" aria-labelledby="exploring-m-code-in-a-power-bi-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploring M Code in a Power BI Semantic Model</h2><p>This section demonstrates how to list and inspect M (Power Query) expressions used in a Power BI Semantic Model within Microsoft Fabric.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_expressions</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s">"LazyDAX"</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-9.png" alt="alt text" /></p><h2 id="list-all-existing-workspaces"> <a href="#list-all-existing-workspaces" class="anchor-heading" aria-labelledby="list-all-existing-workspaces"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List All Existing Workspaces</h2><p><a href="https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-workspaces">https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-workspaces</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_workspaces</span><span class="p">()</span>
</code></pre></div></div><h1 id="listing-semantic-models-from-a-remote-workspace"> <a href="#listing-semantic-models-from-a-remote-workspace" class="anchor-heading" aria-labelledby="listing-semantic-models-from-a-remote-workspace"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Listing Semantic Models from a Remote Workspace</h1><p>This section demonstrates how to list all semantic models available in a specific Power BI workspace using Microsoft Fabric.</p><p><a href="https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-datasets">https://learn.microsoft.com/en-us/python/api/semantic-link-sempy/sempy.fabric?view=semantic-link-python#sempy-fabric-list-datasets</a></p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">list_datasets</span><span class="p">(</span><span class="n">workspace</span><span class="o">=</span><span class="s">"YourWorkspace"</span><span class="p">)</span>
</code></pre></div></div><h1 id="tabular---bpa---best-practice-analyzer"> <a href="#tabular---bpa---best-practice-analyzer" class="anchor-heading" aria-labelledby="tabular---bpa---best-practice-analyzer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tabular - BPA - Best Practice Analyzer</h1><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fabric</span><span class="p">.</span><span class="n">run_model_bpa</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s">"LazyDAX"</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-10.png" alt="alt text" /></p><h2 id="checking-refresh-status-of-a-semantic-model"> <a href="#checking-refresh-status-of-a-semantic-model" class="anchor-heading" aria-labelledby="checking-refresh-status-of-a-semantic-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Checking Refresh Status of a Semantic Model</h2><p>This section demonstrates how to retrieve refresh information for a Power BI Semantic Model in Microsoft Fabric.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sempy.fabric</span> <span class="k">as</span> <span class="n">fabric</span>

<span class="n">fabric</span><span class="p">.</span><span class="n">list_refresh_requests</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s">"LazyDAX"</span><span class="p">)</span>
</code></pre></div></div><p><img src="../../assets/2025/exploring-power-bi-semantic-models-python-microsoft-fabric/image-11.png" alt="alt text" /></p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2015-2024 Arnaud Gastelblum.</p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
